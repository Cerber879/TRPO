**Дата:** 20 сентября 2025 г.

**Статус:** Принято

**Контекст:**

Нужен эффективный полнотекстовый поиск по ресторанам с поддержкой фильтрации по разным критериям (название, тип кухни, местоположение, рейтинг, ценовая категория). PostgreSQL имеет встроенный полнотекстовый поиск, но для сложных запросов может потребоваться специализированное решение.

**Рассмотренные варианты:**

1. **PostgreSQL Full-Text Search:** Встроенные возможности PostgreSQL для полнотекстового поиска. Не требует дополнительной инфраструктуры.
2. **Elasticsearch:** Специализированная поисковая система на основе Apache Lucene. Мощные возможности поиска, агрегации, аналитики.
3. **Apache Solr:** Альтернатива Elasticsearch на основе Lucene. Похожий функционал, но менее популярен.
4. **Algolia:** Управляемый поисковый сервис. Простое API, но платный и менее гибкий.

**Решение:**

Выбран PostgreSQL Full-Text Search на начальном этапе с возможностью миграции на Elasticsearch при необходимости масштабирования.

**Обоснование:**

- **Простота:** Не требует дополнительной инфраструктуры и синхронизации данных между системами.
- **Производительность:** Встроенный полнотекстовый поиск PostgreSQL справится с задачей поиска по названию, описанию, типу кухни для нашей нагрузки.
- **Консистентность данных:** Данные находятся в одной системе, что упрощает поддержку консистентности и снижает сложность архитектуры.
- **Гибкость:** Архитектура позволяет в будущем добавить Elasticsearch для более сложных сценариев поиска без изменения основной логики.
- **Опыт команды:** У нас уже есть опыт работы с полнотекстовым поиском PostgreSQL, что позволит быстро настроить индексы и оптимизировать запросы.

**Недостатки решения:**

- **Ограниченные возможности:** По сравнению с Elasticsearch, возможности полнотекстового поиска PostgreSQL более ограничены (менее гибкий релевантный поиск, нет фасетного поиска "из коробки").
- **Масштабирование:** При очень больших объемах данных может потребоваться переход на специализированное решение.

**Последствия:**

- Необходимо правильно настроить индексы полнотекстового поиска в PostgreSQL (GIN индексы для tsvector).
- Требуется реализовать эффективные запросы с использованием ts_rank для ранжирования результатов.
- При необходимости добавления сложных фильтров и агрегаций следует рассмотреть миграцию на Elasticsearch.
- Рекомендуется документировать процесс миграции на Elasticsearch для будущего масштабирования.

